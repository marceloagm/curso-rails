<h1 class="text-center"> APOSTA RODADA <%= @rodada %> </h1>

<!-- Botão para acionar modal -->
<div style="text-align: center;">
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modalExemplo">
  Participar
</button>
</div>

<h1></h1>

<div class="d-flex flex-row-reverse bd-highlight">
  <%= form_with(url: users_backoffice_search_path, local: true, method: :get) do |time| %>
  <div class="p-3 bd-highlight">
    <div class="input-group input-group-button col-sm-12 col-xl-12">
        <%= time.text_field :term, class:"form-control", placeholder:"Pesquisar Time" %>
        <%= time.hidden_field :rodada, :value => @rodada %>
          <button type="submit" class="input-group-addon btn btn-primary" id="basic-addon10">
            <span class=""><i class="icofont icofont-ui-search"></i></span>
        </button>
    </div>
</div>
 <% end %>
</div>

<div class="col-md-12 col-xl-12">
    <div class="card widget-card-1">
        <div class="card-block-small">
            <i class="bg-c-blue card1-icon"> <h6> Posição </h6> </i>
                    <div class="row">
                    <div class="col-6">
                    
                    <h4 style="color: white">.</h4>
                    <h4>Time</h4>
                    </div>
                    <div class="col-6">
                    
                    <h4 style="color: white">.</h4>
                    <h4>Pontos</h4>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<% @apostas.each do |aposta| %>
<%= link_to  users_backoffice_visualizar_time_time_path(:time => "#{aposta.equipe.nome_time}"), class:"col-md-12 col-xl-12", style:"height:80%;" do %>
      <div class="card widget-card-1">
        <div class="card-block-small">
            <i class=" bg-c-blue card1-icon"><%= @contador %></i>
                    <div class="row">
                    <div class="col-6">
                    
                    <h4 style="color: white">.</h4>
                    <h4><%= aposta.equipe.nome_time %></h4>
                    </div>
                    <div class="col-6">
                    
                    <h4 style="color: white">.</h4>
                    <h4>Pontos</h4>
                    </div>
                </div>
            </div>
        </div>
  <% end %>
    <% @contador = @contador + 1 %>
<% end %>

<div class="pagination justify-content-center">
    <%= paginate @apostas %>
 </div>
<!-- Modal -->
<div class="modal fade" id="modalExemplo" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Participar da Aposta</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
      <% if  @equipes_final == [] %>
                    <h4 class="modal-title" id="exampleModalLabel" style="color: red; text-align: center;"> <b>Atenção</b></h4>
              <h5 class="modal-title" id="exampleModalLabel"><b> Você não consegue participar dessa aposta por um dos motivos a seguir:</b></h5>
              <h5 class="modal-title" id="exampleModalLabel"> 1º Seu(s) Time(s) já está(ão) participando dessa aposta;</h5>
              <h5 class="modal-title" id="exampleModalLabel"> 2º Você não tem time(s) adicionado(s) a sua conta, para adicionar vá até o menu lateral "Meus Times" ou senão clique no botão a seguir: </h5>
              <%= link_to "Adicionar TIme", users_backoffice_equipes_path, class:"btn btn-primary", type:"submit" %>

   <% else %>
      <h4 style="color: black;">1º Passo </h4>
      <h4 class="modal-title" id="exampleModalLabel">Selecione o Time:</h4>
      <%= form_with(url: users_backoffice_apostas_path, method: "post", local:true) do |f| %>
              <%= f.select 'equipe_id', options_for_select(@equipes_final.collect{ |u| [u.nome_time, u.id] }), {}, {class:"form-control"}  %>
              <%= f.hidden_field :rodada, :value => @rodada %>
              <%= f.hidden_field :pagina, :value => "rodada_ddprox" %>
             
       <div class="modal-footer">
      </div>      
      <h4 style="color: black;">2º Passo </h4>
      <h4 class="modal-title" id="exampleModalLabel"> Realize o Pagamento:</h4>
      <h1></h1>
         <script
             src="https://www.mercadopago.com.br/integrations/v1/web-payment-checkout.js"
             data-preference-id="<%= @preference_id %>">
                  
          </script>
          <%= image_tag 'logo-mercadopago.png', alt:"Responsive image", class:"card-img-top", style:"width: 70%;float: right; " %>
       <h1><h1> 
      </div>
      <h style="font-size: 10px;">  *será acrescentado R$ 0,50 no valor final por causa do juros do mercado pago.</h>
       <% end %>
       <% end %>
       
       <div class="modal-footer">      
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
      </div>      
    </div> 
    </div>
</div>
